
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Coastal model (SCHISM, SFINCS) workflow on HPC clusters">
      
      
        <meta name="author" content="Taher Chegini">
      
      
        <link rel="canonical" href="https://NGWPC.github.io/nwm-coastal/stable/hydromt_sfincs_issues/">
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-materialx-10.0.9">
    
    
      
        <title>hydromt-sfincs Bug Reports - NWM Coastal</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.90ee4e44.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.63c7e8c3.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo" data-mx-topbar="glass">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="toc" type="checkbox" id="__toc" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <label class="md-overlay" for="__toc"></label>
    <div data-md-component="skip">
      
        
        <a href="#hydromt-sfincs-bug-reports" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NWM Coastal" class="md-header__button md-logo" aria-label="NWM Coastal" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NWM Coastal
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              hydromt-sfincs Bug Reports
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="prefix-light" data-md-color-accent="prefix-light"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="prefix" data-md-color-accent="prefix"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
        
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.25 2a8.25 8.25 0 0 1 6.34 13.53l5.69 5.69a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215l-5.69-5.69A8.25 8.25 0 1 1 10.25 2M3.5 10.25a6.75 6.75 0 1 0 13.5 0 6.75 6.75 0 0 0-13.5 0"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.25 2a8.25 8.25 0 0 1 6.34 13.53l5.69 5.69a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215l-5.69-5.69A8.25 8.25 0 1 1 10.25 2M3.5 10.25a6.75 6.75 0 1 0 13.5 0 6.75 6.75 0 0 0-13.5 0"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 5.5a3.498 3.498 0 0 1-6.062 2.385l-5.112 3.021a3.5 3.5 0 0 1 0 2.188l5.112 3.021a3.5 3.5 0 1 1-.764 1.29l-5.112-3.02a3.499 3.499 0 1 1-3.843-5.642 3.5 3.5 0 0 1 3.843.872l5.112-3.021A3.5 3.5 0 1 1 20 5.5m-1.5 13a2 2 0 1 0-3.999-.001 2 2 0 0 0 3.999.001m0-13a2 2 0 1 0-3.999-.001A2 2 0 0 0 18.5 5.5M5.5 14a2 2 0 1 0 .001-3.999A2 2 0 0 0 5.5 14"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0">
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/NGWPC/nwm-coastal" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    NGWPC/nwm-coastal
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../getting-started/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../user-guide/configuration/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../DESIGN/" class="md-tabs__link">
        
  
  
    
  
  Design

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/api/" class="md-tabs__link">
          
  
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../CONTRIBUTING/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../CHANGELOG/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../LICENSE" class="md-tabs__link">
        
  
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NWM Coastal" class="md-nav__button md-logo" aria-label="NWM Coastal" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NWM Coastal
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NGWPC/nwm-coastal" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    NGWPC/nwm-coastal
  </div>
</a>
    </div>
  
  <ul class="md-nav__list">
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list">
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list">
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/python-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Python API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/workflow-stages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Stages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../DESIGN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list">
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                



                  


  
    <a href="https://github.com/NGWPC/nwm-coastal/edit/development/docs/hydromt_sfincs_issues.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="hydromt-sfincs-bug-reports"><code>hydromt-sfincs</code> Bug Reports<a class="headerlink" href="#hydromt-sfincs-bug-reports" title="Permanent link">#</a></h1>
<p>Tested against <strong><code>hydromt-sfincs</code></strong> commit
<a href="https://github.com/Deltares/hydromt_sfincs/commit/41aac0a3980fc2714ec28eafb0463d40abfc979a"><code>41aac0a</code></a>.
All issues were discovered while integrating <code>hydromt-sfincs</code> into an automated coastal
calibration pipeline that builds SFINCS models from NWM and STOFS/TPXO forcing data.</p>
<hr />
<h2 id="1-gridded-meteo-reprojection-produces-conus-extent-output-critical-performance-bug">1. Gridded meteo reprojection produces CONUS-extent output (critical performance bug)<a class="headerlink" href="#1-gridded-meteo-reprojection-produces-conus-extent-output-critical-performance-bug" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p><code>SfincsPrecipitation.create()</code>, <code>SfincsWind.create()</code>, and <code>SfincsPressure.create()</code>
produce output grids that can be orders of magnitude larger than the model domain when
the source data uses a different CRS than the model.</p>
<p><strong>Root cause</strong>:</p>
<p>Each <code>create()</code> method follows a two-step pattern (<code>meteo.py</code>, precipitation example at
lines 351-413):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Step 1 — clip in source CRS (correct)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">precip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span><span class="o">.</span><span class="n">get_rasterdataset</span><span class="p">(</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">precip</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">bbox</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bbox</span><span class="p">,</span>   <span class="c1"># model bbox in geographic coords</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">buffer</span><span class="o">=</span><span class="n">buffer</span><span class="p">,</span>           <span class="c1"># 5 km default</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="o">...</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Step 2 — reproject to model CRS (no post-clip)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">precip_out</span> <span class="o">=</span> <span class="n">precip</span><span class="o">.</span><span class="n">raster</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">dst_crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">dst_res</span><span class="o">=</span><span class="n">dst_res</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>
<p>Step 1 correctly extracts a small rectangle in the source CRS (e.g. Lambert Conformal
Conic for NWM LDASIN). Step 2 calls <code>rioxarray.reproject()</code>, which computes the output
extent by transforming the corners of the input rectangle into the target CRS. For
projections with significant non-linearity (LCC → UTM), a small source-CRS rectangle
maps to an enormously inflated bounding box in the target CRS. <code>reproject()</code> faithfully
allocates the full output grid, filling unreachable cells with NaN (subsequently
replaced by <code>.fillna(0)</code>).</p>
<p><strong>There is no clip to the model domain after the reprojection.</strong></p>
<p><strong>Observed impact</strong>:</p>
<p>For a SFINCS model on the Texas Gulf Coast (UTM zone 14N, domain ~143 km x 92 km) with
NWM LDASIN forcing (LCC, ~1 km):</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Expected size</th>
<th>Actual size</th>
<th>Grid dimensions</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sfincs_netampr.nc</code> (precip)</td>
<td>~11 MB</td>
<td><strong>12 GB</strong></td>
<td>4797 x 4085</td>
</tr>
<tr>
<td><code>sfincs_netamuv.nc</code> (wind)</td>
<td>~45 MB</td>
<td><strong>49 GB</strong></td>
<td>4797 x 4085</td>
</tr>
<tr>
<td><code>sfincs_netamp.nc</code> (pressure)</td>
<td>~23 MB</td>
<td><strong>24 GB</strong></td>
<td>4797 x 4085</td>
</tr>
</tbody>
</table>
<p>The output grid covered x = -1,793 km to 3,118 km and y = 2,339 km to 6,581 km in UTM
zone 14N — essentially the entire CONUS. The SFINCS simulation, which must read these
files every time step, slowed from ~7 minutes to an estimated <strong>15+ hours</strong>.</p>
<p><strong>Suggested fix</strong>:</p>
<p>Add a <code>rio.clip_box</code> call after <code>reproject()</code> in each <code>create()</code> method, clipping to
<code>self.model.region.total_bounds</code> with a buffer:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">precip_out</span> <span class="o">=</span> <span class="n">precip</span><span class="o">.</span><span class="n">raster</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">dst_crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">dst_res</span><span class="o">=</span><span class="n">dst_res</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># --- add this ---</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">total_bounds</span>  <span class="c1"># (xmin, ymin, xmax, ymax)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">buf</span> <span class="o">=</span> <span class="n">buffer</span>  <span class="c1"># reuse the same buffer parameter</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">precip_out</span> <span class="o">=</span> <span class="n">precip_out</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip_box</span><span class="p">(</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="n">minx</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">buf</span><span class="p">,</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="n">miny</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">buf</span><span class="p">,</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="n">maxx</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">buf</span><span class="p">,</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">maxy</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">buf</span><span class="p">,</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="p">)</span>
</span></code></pre></div>
<p>This applies identically to <code>SfincsPrecipitation.create()</code> (line 411),
<code>SfincsWind.create()</code> (line 684), and <code>SfincsPressure.create()</code> (line 581).</p>
<p><strong>Current workaround</strong>:</p>
<p>In our pipeline we (a) pass an explicit <code>dst_res</code> derived from the SFINCS quadtree grid
base cell size (via <code>_meteo_dst_res()</code>), and (b) clip each meteo component after
<code>create()</code> and before <code>write()</code> using <code>_clip_meteo_to_domain()</code> (in <code>sfincs_build.py</code>).
This is applied identically to precipitation, wind, and pressure stages. The <code>meteo_res</code>
config option allows users to override the automatic resolution.</p>
<hr />
<h2 id="2-write_gridded-loads-entire-dataset-into-memory-oom-on-large-grids">2. <code>write_gridded</code> loads entire dataset into memory (OOM on large grids)<a class="headerlink" href="#2-write_gridded-loads-entire-dataset-into-memory-oom-on-large-grids" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p><code>SfincsMeteo.write_gridded()</code> (<code>meteo.py</code>, line 180) calls <code>self.data.load()</code>, which
materializes the full lazy <code>dask</code>-backed dataset into RAM. Combined with issue 1
(CONUS-extent grids), this easily exceeds available memory. Even with properly clipped
grids, a 7-day NWM setup with precip + wind + pressure can require ~10-15 GB of
contiguous memory.</p>
<p><strong>Root cause</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">write_gridded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="o">...</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>  <span class="c1"># &lt;-- full materialization</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="o">...</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">ds</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Suggested fix</strong>:</p>
<p>Stream one time step at a time via the netCDF4 library, keeping peak memory near ~150 MB
regardless of the total dataset size. See the <code>_write_gridded_lazy</code> implementation in
our monkey-patch for a working reference (writes each <code>ds.isel(time=i).compute()</code> to a
pre-created netCDF4 file with an unlimited time dimension).</p>
<p><strong>Current workaround</strong>:</p>
<p>We monkey-patch <code>SfincsMeteo.write_gridded</code> at import time (via
<code>patch_meteo_write_gridded()</code> in <code>_hydromt_compat.py</code>, called from
<code>apply_all_patches()</code>) to replace it with a streaming writer that writes one time-step
at a time via <code>netCDF4.Dataset</code>, keeping peak memory near ~150 MB instead of
materializing the full 3-D array.</p>
<hr />
<h2 id="3-write_netcdf_safely-can-crash-the-hdf5-c-library-on-incompatible-files">3. <code>write_netcdf_safely</code> can crash the HDF5 C library on incompatible files<a class="headerlink" href="#3-write_netcdf_safely-can-crash-the-hdf5-c-library-on-incompatible-files" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p><code>write_netcdf_safely()</code> (<code>utils.py</code>, line 1921) opens an existing netCDF file to check
whether the data changed before overwriting. If the existing file has an incompatible
schema (e.g. different number of stations, different dimension sizes), the HDF5 library
can segfault during the comparison read.</p>
<p><strong>Root cause</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">write_netcdf_safely</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">abs_file_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="k">if</span> <span class="n">abs_file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>            <span class="n">existing_ds</span> <span class="o">=</span> <span class="n">GeoDataset</span><span class="o">.</span><span class="n">from_netcdf</span><span class="p">(</span>  <span class="c1"># &lt;-- crash here</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>                <span class="n">abs_file_path</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">raster</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>            <span class="p">)</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>            <span class="n">changed</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">ds</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">existing_ds</span><span class="p">)</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>            <span class="n">existing_ds</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>            <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># fail-safe</span>
</span></code></pre></div>
<p>The <code>except Exception</code> on line 1952 is intended as a fail-safe, but the crash occurs
inside the HDF5 C library (<code>H5VL__native_blob_specific</code> → <code>H5T__vlen_disk_isnull</code>),
which raises <code>SIGTERM</code>/<code>SIGSEGV</code> rather than a Python exception. The process is killed
before the except clause can execute.</p>
<h3 id="reproduction">Reproduction<a class="headerlink" href="#reproduction" title="Permanent link">#</a></h3>
<ol>
<li>Run a SFINCS pipeline that writes <code>sfincs_netbndbzsbzifile.nc</code> with 119,903 stations
    (e.g. from un-interpolated STOFS data).</li>
<li>Fix the pipeline to produce the correct 15 stations.</li>
<li>Re-run. <code>write_netcdf_safely</code> opens the old 119,903-station file to compare with the
    new 15-station dataset. The HDF5 library segfaults (exit code 139) during
    <code>GeoDataset.from_netcdf()</code>.</li>
</ol>
<p><strong>Suggested fix</strong>:</p>
<p>The comparison-before-write optimization is fragile when files can have entirely
different schemas across runs. Options:</p>
<ul>
<li><strong>Option A (simple):</strong> Delete the existing file before writing instead of comparing.
    The comparison only saves a write when the data is identical, which is uncommon in a
    re-run scenario.</li>
<li><strong>Option B (defensive):</strong> Compare only metadata (dimensions, shapes, dtypes) before
    attempting a full <code>ds.equals()</code>. Skip the comparison entirely if schemas differ.</li>
</ul>
<p><strong>Current workaround</strong>:</p>
<p><code>SfincsInitStage._remove_stale_outputs()</code> deletes all generated netCDF files (forcing,
output, boundary) at the start of every pipeline run, so <code>write_netcdf_safely</code> never
encounters a stale file with an incompatible schema.</p>
<hr />
<h2 id="4-_validate_and_prepare_gdf-hard-codes-index-dimension-name">4. <code>_validate_and_prepare_gdf</code> hard-codes <code>"index"</code> dimension name<a class="headerlink" href="#4-_validate_and_prepare_gdf-hard-codes-index-dimension-name" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p><code>BoundaryConditionComponent._create_dummy_dataset</code> uses <code>dims=("time", "index")</code>, but
<code>GeoDataset.from_gdf</code> derives the spatial dimension name from <code>gdf.index.name</code>. When the
input GeoDataFrame's index is named something other than <code>"index"</code> (e.g. <code>"node"</code> from
ADCIRC/STOFS data), the dimension names diverge and <code>from_gdf</code> raises:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="n">Index</span> <span class="n">dimension</span> <span class="n">node</span> <span class="ow">not</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">data_vars</span>
</span></code></pre></div>
<p><strong>Root cause</strong>:</p>
<p><code>_validate_and_prepare_gdf</code> does not normalize the GDF index name to <code>"index"</code> before it
is used downstream.</p>
<p><strong>Suggested fix</strong>:</p>
<p>At the end of <code>_validate_and_prepare_gdf</code>, ensure the index name is always <code>"index"</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">_validate_and_prepare_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdf</span><span class="p">):</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="o">...</span>  <span class="c1"># existing validation</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>        <span class="n">gdf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;index&quot;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="k">return</span> <span class="n">gdf</span>
</span></code></pre></div>
<p><strong>Current workaround</strong>:</p>
<p><code>patch_boundary_conditions_index_dim()</code> in <code>_hydromt_compat.py</code> (called from
<code>apply_all_patches()</code>) monkey-patches <code>SfincsBoundaryBase._validate_and_prepare_gdf</code> to
normalize the GDF index name to <code>"index"</code> after validation.</p>
<hr />
<h2 id="5-_serialize_crs-crashes-on-crs-without-an-authority-code">5. <code>_serialize_crs</code> crashes on CRS without an authority code<a class="headerlink" href="#5-_serialize_crs-crashes-on-crs-without-an-authority-code" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p><code>hydromt.typing.crs._serialize_crs</code> calls <code>list(crs.to_authority())</code> without guarding
against <code>to_authority()</code> returning <code>None</code>. This raises
<code>TypeError: 'NoneType' object is not iterable</code> for any CRS that has no EPSG code and no
recognized authority (e.g. custom <code>proj</code> strings).</p>
<p><strong>Suggested fix</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">_serialize_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">):</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">epsg</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="k">if</span> <span class="n">epsg</span><span class="p">:</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="k">return</span> <span class="n">epsg</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">auth</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">to_authority</span><span class="p">()</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="k">if</span> <span class="n">auth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="k">return</span> <span class="n">crs</span><span class="o">.</span><span class="n">to_wkt</span><span class="p">()</span>
</span></code></pre></div>
<p>Note: this is in <strong><code>hydromt</code></strong> core, not <code>hydromt-sfincs</code>.</p>
<p><strong>Current workaround</strong>:</p>
<p><code>patch_serialize_crs()</code> in <code>_hydromt_compat.py</code> (called from <code>apply_all_patches()</code>)
swaps the function's <code>__code__</code> in-place at import time so that existing <code>Pydantic</code>
<code>PlainSerializer</code> references pick up the fix.</p>
<hr />
<h2 id="6-nwm-ldasin-coordinate-rounding-errors-rejected-as-irregular-grid">6. NWM LDASIN coordinate rounding errors rejected as irregular grid<a class="headerlink" href="#6-nwm-ldasin-coordinate-rounding-errors-rejected-as-irregular-grid" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p>NWM LDASIN files store projected coordinates (LCC, in meters) with floating-point
rounding errors up to ~0.125 m. <code>hydromt</code>'s raster accessor rejects them with:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">regular</span> <span class="n">grid</span>
</span></code></pre></div>
<p>because its internal tolerance (<code>atol=5e-4</code>) is too tight for meter-scale coordinates.</p>
<p><strong>Suggested fix</strong>:</p>
<p>Either increase the tolerance or provide a built-in <code>round_coords</code> preprocessor that
users can reference in their data catalog YAML:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nt">nwm_ana_meteo</span><span class="p">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">driver_kwargs</span><span class="p p-Indicator">:</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span><span class="nt">preprocess</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">round_coords</span>
</span></code></pre></div>
<p>Note: this is in <strong><code>hydromt</code></strong> core.</p>
<p><strong>Current workaround</strong>:</p>
<p><code>register_round_coords_preprocessor()</code> in <code>_hydromt_compat.py</code> (called from
<code>apply_all_patches()</code>) registers a custom <code>round_coords</code> preprocessor in <code>hydromt</code>'s
<code>PREPROCESSORS</code> dictionary that rounds x/y coordinates to the nearest integer before the
regularity check.</p>
<hr />
<h2 id="7-water_levelcreategeodataset-passes-all-source-stations-to-netcdf-output">7. <code>water_level.create(geodataset=...)</code> passes all source stations to netCDF output<a class="headerlink" href="#7-water_levelcreategeodataset-passes-all-source-stations-to-netcdf-output" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p><code>SfincsWaterLevel.create(geodataset=...)</code> passes <em>all</em> source stations found within the
model region to the boundary netCDF file. When the model has a <code>.bnd</code> file that defines
explicit boundary points (the normal SFINCS setup), the station count in the netCDF must
exactly match the boundary point count. The mismatch causes SFINCS to either crash or
silently produce incorrect boundary forcing.</p>
<p><strong>Root cause</strong>:</p>
<p>The <code>create()</code> code path loads the <code>geodataset</code>, clips it to the model region, and
writes all matching stations to <code>sfincs_netbndbzsbzifile.nc</code> without checking whether a
<code>.bnd</code> file exists or how many boundary points it defines. For a STOFS <code>geodataset</code> over
the Texas Gulf Coast domain, this can yield ~119,903 source stations, far more than the
15 boundary points in <code>sfincs.bnd</code>.</p>
<p><strong>Suggested fix</strong>:</p>
<p>When a <code>.bnd</code> file exists, <code>water_level.create()</code> should spatially interpolate the
<code>geodataset</code> to the boundary point locations (e.g. via IDW from the nearest source
nodes) and write only those interpolated time-series, matching the <code>.bnd</code> point count.</p>
<p><strong>Current workaround</strong>:</p>
<p><code>SfincsForcingStage._create_geodataset_forcing()</code> in <code>sfincs_build.py</code> bypasses
<code>model.water_level.create(geodataset=...)</code> entirely. It reads the <code>.bnd</code> file, loads the
<code>geodataset</code>, spatially interpolates to each boundary point using inverse-distance
weighting (IDW) from the nearest source nodes, then injects the result via
<code>model.water_level.set(df=..., gdf=...)</code>.</p>
<hr />
<h2 id="8-missing-bzi-infragravity-variable-in-boundary-netcdf">8. Missing <code>bzi</code> (infragravity) variable in boundary netCDF<a class="headerlink" href="#8-missing-bzi-infragravity-variable-in-boundary-netcdf" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p>SFINCS unconditionally reads a <code>zi</code> (infragravity water level) variable from the
boundary netCDF file (<code>sfincs_ncinput.F90:118</code>). When <code>hydromt-sfincs</code> writes
<code>sfincs_netbndbzsbzifile.nc</code> it only writes <code>bzs</code> (surface water level), omitting <code>bzi</code>.
SFINCS crashes with a netCDF read error on startup.</p>
<p><strong>Root cause</strong>:</p>
<p>The boundary writer in <code>hydromt-sfincs</code> does not generate the <code>bzi</code> variable. SFINCS's
Fortran I/O code does not check whether <code>zi</code> exists before attempting to read it, so the
missing variable causes a hard crash rather than a graceful fallback to zero.</p>
<p><strong>Suggested fix</strong>:</p>
<p><code>hydromt-sfincs</code> should always write a <code>bzi</code> variable alongside <code>bzs</code>. If no
infragravity data is available, it should be zero-filled with the same shape as <code>bzs</code>.</p>
<p><strong>Current workaround</strong>:</p>
<p><code>SfincsForcingStage._inject_water_level()</code> in <code>sfincs_build.py</code> manually adds a
zero-filled <code>bzi</code> variable after calling <code>model.water_level.set()</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">water_level</span><span class="o">.</span><span class="n">data</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">if</span> <span class="s2">&quot;bzi&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;bzi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;bzs&quot;</span><span class="p">])</span>
</span></code></pre></div>
<hr />
<h2 id="9-discharge-source-points-on-inactive-grid-cells-cause-segfault">9. Discharge source points on inactive grid cells cause segfault<a class="headerlink" href="#9-discharge-source-points-on-inactive-grid-cells-cause-segfault" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p>When a discharge source point (from the <code>.src</code> file) falls on an inactive grid cell
(<code>mask != 1</code>), SFINCS segfaults during the simulation. This is a Fortran-side bug but
<code>hydromt-sfincs</code> should validate source locations against the grid mask before writing.</p>
<p><strong>Root cause</strong>:</p>
<p>The SFINCS Fortran binary maps each source point to the nearest grid cell. If that cell
is inactive, the cell index is left at its default value of 0. The code later accesses
<code>zs(0)</code> (water level at cell 0) without a bounds check, causing a segfault (exit code
139) or out-of-bounds array access.</p>
<p><strong>Suggested fix</strong>:</p>
<p><code>hydromt-sfincs</code> should validate discharge source points against the grid mask when they
are added and either:</p>
<ul>
<li><strong>Option A (strict):</strong> Raise an error listing the offending points.</li>
<li><strong>Option B (lenient):</strong> Drop inactive-cell points with a warning, keeping only those
    on active cells.</li>
</ul>
<p><strong>Current workaround</strong>:</p>
<p><code>SfincsDischargeStage._filter_active_cells()</code> in <code>sfincs_build.py</code> uses
<code>scipy.spatial.cKDTree</code> to map each source point to its nearest quadtree face, checks
the face mask value, and drops points on inactive cells. The names of dropped points are
logged as a warning.</p>
<hr />
<h2 id="10-_parse_river_list-crashes-on-freshly-created-models-keyerror-geoms">10. <code>_parse_river_list</code> crashes on freshly created models (<code>KeyError: 'geoms'</code>)<a class="headerlink" href="#10-_parse_river_list-crashes-on-freshly-created-models-keyerror-geoms" title="Permanent link">#</a></h2>
<p><strong>Summary</strong>:</p>
<p><code>SfincsModel._parse_river_list()</code> crashes with <code>KeyError: 'geoms'</code> when called on a
model created in write mode (<code>mode="w+"</code>). This makes it impossible to use river burning
(<code>burn_river_rect</code>) during subgrid table creation on new models — i.e. whenever
<code>subgrid.create(river_list=...)</code> is called as part of a model-building workflow rather
than on a model read from disk.</p>
<p><strong>Root cause</strong>:</p>
<p><code>_parse_river_list</code> (<code>sfincs.py</code>, line 744) checks whether a river centerline dataset
name already exists as a loaded model geometry:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rivers</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geoms</span><span class="p">:</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">gdf_riv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geoms</span><span class="p">[</span><span class="n">rivers</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">gdf_riv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span><span class="o">.</span><span class="n">get_geodataframe</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</span></code></pre></div>
<p>In <code>hydromt</code> v1+, <code>self.geoms</code> is resolved via <code>Model.__getattr__</code> →
<code>Model.get_component</code>, which looks up <code>"geoms"</code> in the component registry
(<code>self.components["geoms"]</code>). On freshly created models the <code>geoms</code> component is never
registered, so the lookup raises:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="ne">KeyError</span><span class="p">:</span> <span class="s2">&quot;geoms&quot;</span>
</span></code></pre></div>
<p>Python's <code>and</code> operator should short-circuit, but the <code>KeyError</code> is raised by the
attribute access itself (<code>self.geoms</code>), not by the <code>in</code> operator. The exception
propagates before the <code>in</code> check can execute, and the <code>else</code> branch
(<code>data_catalog.get_geodataframe</code>) — which is the correct code path for new models — is
never reached.</p>
<h3 id="reproduction_1">Reproduction<a class="headerlink" href="#reproduction_1" title="Permanent link">#</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">hydromt_sfincs</span><span class="w"> </span><span class="kn">import</span> <span class="n">SfincsModel</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">sf</span> <span class="o">=</span> <span class="n">SfincsModel</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s2">&quot;./test_model&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+&quot;</span><span class="p">,</span> <span class="n">data_libs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;my_catalog.yml&quot;</span><span class="p">])</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c1"># ... create grid, elevation, mask, roughness ...</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="n">sf</span><span class="o">.</span><span class="n">subgrid</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    <span class="n">elevation_list</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;elevation&quot;</span><span class="p">:</span> <span class="s2">&quot;dem&quot;</span><span class="p">}],</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    <span class="n">roughness_list</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;lulc&quot;</span><span class="p">:</span> <span class="s2">&quot;esa_worldcover&quot;</span><span class="p">}],</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>    <span class="n">river_list</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;centerlines&quot;</span><span class="p">:</span> <span class="s2">&quot;my_rivers&quot;</span><span class="p">}],</span>  <span class="c1"># &lt;-- KeyError: &#39;geoms&#39;</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>    <span class="n">nr_subgrid_pixels</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Suggested fix</strong>:</p>
<p>Guard the <code>self.geoms</code> access in <code>_parse_river_list</code> so that a missing component is
treated the same as an empty one:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    <span class="n">model_geoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geoms</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="n">model_geoms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rivers</span> <span class="ow">in</span> <span class="n">model_geoms</span><span class="p">:</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>    <span class="n">gdf_riv</span> <span class="o">=</span> <span class="n">model_geoms</span><span class="p">[</span><span class="n">rivers</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    <span class="n">gdf_riv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span><span class="o">.</span><span class="n">get_geodataframe</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Current workaround</strong>:</p>
<p><code>patch_parse_river_list_geoms()</code> in <code>_hydromt_compat.py</code> (called from
<code>apply_all_patches()</code>) wraps <code>_parse_river_list</code> to temporarily inject an empty dict
into the model instance's <code>__dict__</code> under the key <code>"geoms"</code> when the component is
missing. Python's normal attribute lookup finds the instance dict entry before falling
through to <code>__getattr__</code>, so <code>self.geoms</code> resolves to <code>{}</code> and the <code>in</code> check evaluates
to <code>False</code>.</p>





                

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
          <div class="md-top" data-md-component="top" hidden>
  <div class="md-top__center">
    <button type="button" class="md-top__button md-top__button--main" data-md-action="top">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
      <span>Back to top</span>
    </button>
    
      
      
      <label class="md-top__button md-top__side md-top__side--nav" for="__drawer" >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m0 14H9V6h11Z"/></svg>
      </label>
    
    
  </div>
</div>
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Raytheon Company. BSD-2-Clause License.
    </div>
  
  
    Made with
    <a href="https://jaywhj.github.io/mkdocs-materialx/" target="_blank" rel="noopener">
      MaterialX for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/NGWPC/nwm-coastal" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tabs.link", "navigation.collapse", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.path", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6a56f36d.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>